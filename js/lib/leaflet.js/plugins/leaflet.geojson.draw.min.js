L.GeoJSON=L.FeatureGroup.extend({initialize:function(e,t){L.setOptions(this,t);this._layers={};if(e){this.addData(e)}},addData:function(e){var t=L.Util.isArray(e)?e:e.features,n,r,i;if(t){for(n=0,r=t.length;n<r;n++){i=t[n];if(i.geometries||i.geometry||i.features||i.coordinates){this.addData(t[n])}}return this}var s=this.options;if(s.filter&&!s.filter(e)){return}var o=L.GeoJSON.geometryToLayer(e,s.pointToLayer,s.coordsToLatLng,s);o.feature=L.GeoJSON.asFeature(e);o.defaultOptions=o.options;this.resetStyle(o);if(s.onEachFeature){s.onEachFeature(e,o)}return this.addLayer(o)},resetStyle:function(e){var t=this.options.style;if(t){L.Util.extend(e.options,e.defaultOptions);this._setLayerStyle(e,t)}},setStyle:function(e){this.eachLayer(function(t){this._setLayerStyle(t,e)},this)},_setLayerStyle:function(e,t){if(typeof t==="function"){t=t(e.feature)}if(e.setStyle){e.setStyle(t)}}});L.extend(L.GeoJSON,{geometryToLayer:function(e,t,n,r){var i=e.type==="Feature"?e.geometry:e,s=i.coordinates,o=[],u,a,f,l;n=n||this.coordsToLatLng;switch(i.type){case"Point":u=n(s);return t?t(e,u):new L.Marker(u);case"MultiPoint":for(f=0,l=s.length;f<l;f++){u=n(s[f]);o.push(t?t(e,u):new L.Marker(u))}return new L.FeatureGroup(o);case"LineString":a=this.coordsToLatLngs(s,0,n);return new L.Polyline(a,r);case"Polygon":if(s.length===2&&!s[1].length){throw new Error("Invalid GeoJSON object.")}a=this.coordsToLatLngs(s,1,n);return new L.Polygon(a,r);case"MultiLineString":a=this.coordsToLatLngs(s,1,n);return new L.MultiPolyline(a,r);case"MultiPolygon":a=this.coordsToLatLngs(s,2,n);return new L.MultiPolygon(a,r);case"GeometryCollection":for(f=0,l=i.geometries.length;f<l;f++){o.push(this.geometryToLayer({geometry:i.geometries[f],type:"Feature",properties:e.properties},t,n,r))}return new L.FeatureGroup(o);case"Circle":var c=s[0];u=new L.LatLng(c[1],c[0]);return new L.Circle(u,i.radius);default:throw new Error("Invalid GeoJSON object.")}},coordsToLatLng:function(e){return new L.LatLng(e[1],e[0],e[2])},coordsToLatLngs:function(e,t,n){var r,i,s,o=[];for(i=0,s=e.length;i<s;i++){r=t?this.coordsToLatLngs(e[i],t-1,n):(n||this.coordsToLatLng)(e[i]);o.push(r)}return o},latLngToCoords:function(e){var t=[e.lng,e.lat];if(e.alt!==undefined){t.push(e.alt)}return t},latLngsToCoords:function(e){var t=[];for(var n=0,r=e.length;n<r;n++){t.push(L.GeoJSON.latLngToCoords(e[n]))}return t},getFeature:function(e,t){return e.feature?L.extend({},e.feature,{geometry:t}):L.GeoJSON.asFeature(t)},asFeature:function(e){if(e.type==="Feature"){return e}return{type:"Feature",properties:{},geometry:e}}});var PointToGeoJSON={toGeoJSON:function(){return L.GeoJSON.getFeature(this,{type:"Point",coordinates:L.GeoJSON.latLngToCoords(this.getLatLng())})}};L.Marker.include(PointToGeoJSON);L.CircleMarker.include(PointToGeoJSON);L.Circle.include({toGeoJSON:function(){return{type:"Circle",coordinates:[[this.getLatLng().lng,this.getLatLng().lat]],radius:this.getRadius()}}});L.Polyline.include({toGeoJSON:function(){return L.GeoJSON.getFeature(this,{type:"LineString",coordinates:L.GeoJSON.latLngsToCoords(this.getLatLngs())})}});L.Polygon.include({toGeoJSON:function(){var e=[L.GeoJSON.latLngsToCoords(this.getLatLngs())],t,n,r;e[0].push(e[0][0]);if(this._holes){for(t=0,n=this._holes.length;t<n;t++){r=L.GeoJSON.latLngsToCoords(this._holes[t]);r.push(r[0]);e.push(r)}}return L.GeoJSON.getFeature(this,{type:"Polygon",coordinates:e})}});(function(){function e(e){return function(){var t=[];this.eachLayer(function(e){t.push(e.toGeoJSON().geometry.coordinates)});return L.GeoJSON.getFeature(this,{type:e,coordinates:t})}}L.MultiPolyline.include({toGeoJSON:e("MultiLineString")});L.MultiPolygon.include({toGeoJSON:e("MultiPolygon")});L.LayerGroup.include({toGeoJSON:function(){var t=this.feature&&this.feature.geometry,n=[],r;if(t&&t.type==="MultiPoint"){return e("MultiPoint").call(this)}var i=t&&t.type==="GeometryCollection";this.eachLayer(function(e){if(e.toGeoJSON){r=e.toGeoJSON();n.push(i?r.geometry:L.GeoJSON.asFeature(r))}});if(i){return L.GeoJSON.getFeature(this,{geometries:n,type:"GeometryCollection"})}return{type:"FeatureCollection",features:n}}})})();L.geoJson=function(e,t){return new L.GeoJSON(e,t)}